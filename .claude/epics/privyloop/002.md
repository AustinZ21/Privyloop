---
name: "Database Schema & Core Models"
status: "open"
created: "2025-09-03T22:33:42Z"
updated: "2025-09-03T22:33:42Z"
github: "https://github.com/AustinZ21/Privyloop/issues/3"
depends_on: ["001"]
parallel: false
conflicts_with: []
---

# Task 002 - Database Schema & Core Models

## Description

Design and implement the core database schema for PrivyLoop using PostgreSQL and Drizzle ORM. Create foundational models for users, platforms, privacy settings, and monitoring data with proper relationships and indexing for performance.

## Acceptance Criteria

- [ ] PostgreSQL database schema with Drizzle ORM integration
- [ ] Core tables: users, platforms, privacy_settings, privacy_snapshots
- [ ] Database migrations system with version control
- [ ] Type-safe database queries and models exported from packages/core

## Technical Details

### Database Schema Design
```sql
-- Users table for authentication and profile
users (id, email, created_at, updated_at, subscription_tier)

-- Supported platforms (Facebook, Google, etc.)
platforms (id, name, slug, api_config, scraping_config)

-- Privacy settings tracked per platform
privacy_settings (id, platform_id, setting_name, setting_path, description)

-- Historical snapshots of user privacy states
privacy_snapshots (id, user_id, platform_id, settings_data, scraped_at)
```

### Drizzle ORM Setup
- Schema definitions with proper TypeScript types
- Relationship mapping between entities
- Migration generation and execution system
- Connection pooling for production deployment

### Data Models
- User management with subscription tiers
- Platform configuration for scraping logic
- Privacy setting definitions and metadata
- Historical tracking with efficient querying

## Dependencies

- **Task 001**: Requires monorepo structure and packages/core setup
- PostgreSQL instance (local development + production)

## Effort Estimate

**Medium (2-3 days)**
- Day 1: Schema design, Drizzle setup, core table creation
- Day 2: Relationships, migrations, and data validation
- Day 3: Query optimization, indexing, and testing

## Definition of Done

- [ ] All core tables created with proper constraints and indexes
- [ ] Drizzle ORM configured with type-safe queries
- [ ] Database migrations working in both development and production
- [ ] Core models exported from packages/core with full TypeScript support
- [ ] Test database setup with sample data for development